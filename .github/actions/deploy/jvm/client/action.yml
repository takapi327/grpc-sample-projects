name: Deploy Action
description: JVMのMicroServiceClientデプロイアクション

runs:
  using: composite

  steps:
    - name: Set up JDK 11
      uses: actions/setup-java@v1
      with:
        java-version: 11
        java-package: jdk
        architecture: x64

    - name: Configure AWS Credentials
      uses: aws-actions/configure-aws-credentials@v1
      with:
        aws-region:     ap-northeast-1
        role-to-assume: 'arn:aws:iam::415821524965:role/deploy-github-actions'

    - name: Run sbt release
      env:
        GITHUB_USER:  ${{ github.actor }}
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      working-directory: jvm/fs2-grpc-example
      run:
        sbt ++3.2.2 "project client" "release with-defaults"
      shell: bash
